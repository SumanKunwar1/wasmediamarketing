<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="shortcut icon" href="/images/was-logo.png" type="image/x-icon">
  <meta name="description" content="">
  <meta name="csrf-token" content="NsLCyQVTyMPEh7KnVsmqHWbD67ixNGRAYgSJbDD0">

  <title>WAS Media Marketing </title>
  <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">

  <link rel="stylesheet" type="text/css" href="/css/public.css">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">

  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>


</head>

<body class="hold-transition skin-blue sidebar-mini">
  <div class="wrapper">
    <!-- header -->
    <header class="main-header">
      <!-- Logo -->
      <a href="/admin/dashboard" class="logo">
        <!-- mini logo for sidebar mini 50x50 pixels -->
        <span class="logo-mini"><b>WAS</b>T</span>
        <!-- logo for regular state and mobile devices -->
        <span class="logo-lg">WAS Media Marketing</span>
      </a>
      <!-- Header Navbar: style can be found in header.less -->
      <nav class="navbar navbar-static-top" role="navigation">
        <!-- Sidebar toggle button-->
        <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">
          <span class="sr-only">Toggle navigation</span>
        </a>
        <div class="navbar-custom-menu">
          <ul class="nav navbar-nav">
            <li class="dropdown messages-menu">
              <a href="">
                <span class="hidden-xs">Tue, Sep 17, 2024 1:08 PM</span>
              </a>
            </li>
            <li class="dropdown messages-menu">
              <span><a href="https://WAS Media Marketing.org/admin/update-at" class="btn btn-default"
                  onClick="return confirm('Are you sure you want to update?')" style="margin-top:3mm"> Update
                </a></span>

            </li>
            <!-- User Account: style can be found in dropdown.less -->
            <li class="dropdown user user-menu">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                <img src="/images/c-1.png" class="user-image" alt="User Image">
                <span class="hidden-xs">admin</span>
              </a>
              <ul class="dropdown-menu">
                <!-- User image -->
                <li class="user-header">
                  <img src="/images/c-1.png" class="img-circle" alt="User Image">
                  <p>
                    WAS Media Marketing
                    <small><a href="/cdn-cgi/l/email-protection" class="__cf_email__"
                        data-cfemail="95fcfbf3fad5fbf2ece0fbf2fbf0bbfae7f2">[email&#160;protected]</a></small>
                  </p>
                </li>
                <!-- Menu Footer-->
                <li class="user-footer">
                  <div class="pull-left">
                    <a href="" class="btn btn-default btn-flat">Profile</a>
                  </div>
                  <div class="pull-right">
                    <a href="/admin/logout" class="btn btn-default btn-flat">Sign out</a>
                  </div>
                </li>
              </ul>
            </li>
          </ul>
        </div>
      </nav>
    </header>
    <!-- Left side column. contains the logo and sidebar -->
    <aside class="main-sidebar">
      <!-- sidebar: style can be found in sidebar.less -->
      <section class="sidebar">
        <!-- Sidebar user panel -->
        <div class="user-panel">
          <div class="pull-left image">
            <img src="/images/c-1.png" class="img-circle" alt="User Image">
          </div>
          <div class="pull-left info">
            <p>WAS Media Marketing</p>
            <a href=""><i class="fa fa-circle text-success"></i> Online</a>
          </div>
        </div>

        <!-- sidebar menu: : style can be found in sidebar.less -->
        <ul class="sidebar-menu">
          <li class="active">
            <a href="/admin/dashboard"><i class="fa fa-dashboard"></i> <span>Dashboard</span>
            </a>

          </li>
          <li class="">
            <a href="/admin/enquiry">
              <i class="fa fa-check-circle"></i> <span>General Inquiry</span>
            </a>
          </li>

          <li class="">
            <a href="/admin/page">
              <i class="fa fa-check-circle"></i> <span>Pages</span>
            </a>
          </li>
          <li class="">
            <a href="/admin/file">
              <i class="fa fa-check-circle"></i> <span>Files</span>
            </a>
          </li>






          <li class="">
            <a href="/admin/slider"><i class="fa fa-exchange"></i>Slider</a>
          </li>

          <li class="">
            <a href="/admin/faq"><i class="fa fa-question-circle"></i> FAQ</a>
          </li>




          <li class="">
            <a href="/admin/social-link">
              <i class="fa fa-link"></i> <span>Social Links</span>
            </a>
          </li>
          <li class="">
            <a href="/admin/navbar">
              <i class="fa fa-cog"></i> <span>Navbar</span>
            </a>
          </li>
          <li class="">
            <a href="/admin/subscriber">
              <i class="fa fa-cog"></i> <span>NewsLetter</span>
            </a>
          </li>

        </ul>
      </section>
      <!-- /.sidebar -->
    </aside>


    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper">

      <!-- Content Header (Page header) -->
      <section class="content-header">
        <h1>
          Pages
          <small>The description of pages can be changed here. </small>
        </h1>
        <ol class="breadcrumb">
          <li><a href="/admin/dashboard"><i class="fa fa-dashboard"></i> Home</a></li>
          <li><a href="/admin/page"> Pages</a></li>
          <li class="active">Add Pages</li>
        </ol>
      </section>

      <!-- Main content -->
      <section class="content">
        <!-- Main row -->
        <div class="row">
          <section class="col-md-12">
            <div class="box box-primary">
              <div class="box-header with-border">
                <h3 class="box-title">Add Page</h3>
              </div><!-- /.box-header -->

              <!-- form start -->
              <form role="form" method="post" enctype="multipart/form-data" data-parsley-validate="">
                <div class="box-body">
                  <!-- Title -->
                  <div class="form-group">
                    <label for="title">Title</label>
                    <input type="text" class="form-control" placeholder="Title" name="title" id="title" required>
                  </div>

                  <!-- URL Slug -->
                  <div class="form-group">
                    <label for="urlSlug">URL Slug</label>
                    <input type="text" class="form-control" placeholder="URL Slug" name="urlSlug" id="urlSlug" required>
                  </div>

                  <!-- Page Type -->
                  <div class="form-group">
                    <label for="pageType">Page Type</label>
                    <input type="text" class="form-control" placeholder="Page Type" name="pageType" id="pageType"
                      required>
                  </div>

                  <!-- Cover Image -->
                  <div class="form-group">
                    <label for="image">Cover Image</label>
                    <input type="text" class="form-control" id="image" name="image" readonly
                      placeholder="Choose an image">
                    <button type="button" id="openImageSelector" class="btn btn-primary">Choose Image</button>
                  </div>

                  <!-- File Selector -->
                  <div class="form-group mt-3">
                    <label for="file">Select File</label>
                    <input type="text" class="form-control" id="file" name="file" readonly placeholder="Choose a file">
                    <button type="button" id="openFileSelector" class="btn btn-primary">Choose File</button>
                  </div>

                  <!-- Description -->
                  <div class="form-group">
                    <label for="content">Description</label>
                    <textarea class="form-control" rows="5" placeholder="Description" name="description"
                      id="content"></textarea>
                  </div>

                </div><!-- /.box-body -->

                <div class="box-footer">
                  <div class="container-fluid">
                    <div class="meta-information row">

                      <!-- Meta Title and Meta Keyword -->
                      <div class="col-md-6">
                        <label for="meta-title" class="form-label">Meta Title</label>
                        <input type="text" class="form-control" id="meta-title" name="metaTitle"
                          placeholder="Meta Title">
                      </div>
                      <div class="col-md-6">
                        <label for="meta-keyword" class="form-label">Meta Keyword</label>
                        <input type="text" class="form-control" id="meta-keyword" name="metaKeywords"
                          placeholder="Meta Keywords (comma separated)">
                      </div>

                      <!-- Meta Description -->
                      <div class="col-12 meta-description">
                        <label for="meta-description" class="form-label">Meta Description</label>
                        <textarea class="form-control" id="meta-description" rows="4" placeholder="Meta Description"
                          name="metaDescription"></textarea>
                      </div>
                    </div>
                  </div>

                  <!-- Submit Button -->
                  <button type="submit" class="btn btn-primary pull-right" id="submit-all">Save</button>
                </div>
              </form>
            </div>
          </section>
        </div>
      </section><!-- /.content -->
      <!-- /.content -->
      <!-- Modal for Image/File Selection -->
      <div class="modal" id="selectorModal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="modalTitle">Select Item</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <div id="selectorContainer" class="row">
                <!-- Dynamic items will be loaded here -->
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
          </div>
        </div>
      </div>
    </div><!-- /.content-wrapper -->

    <!-- footer -->
    <footer class="main-footer">

      <strong>Copyright &copy;

        <strong>
    </footer>
  </div><!-- ./wrapper -->
  <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script>
  <script src="/js/all.js"></script>
  <!-- <script src="/js/tinymce.min.js"></script> -->
  <script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.2/moment.min.js"></script>


  <!-- <script src="https://ngyungne.org/public/admin/plugins/iCheck/icheck.min.js"></script> -->
  <script type="text/javascript">
    //Flat red color scheme for iCheck
    $('input[type="checkbox"].flat-red, input[type="radio"].flat-red').iCheck({
      checkboxClass: 'icheckbox_flat-green',
      radioClass: 'iradio_flat-green'
    });
  </script>
  <script src="https://ngyungne.org/public/admin/plugins/tinymce/tinymce.min.js"></script>

  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/tinymce/5.10.1/tinymce.min.js"></script> -->

  <script>
    tinymce.init({
      selector: "#content", // Your text area selector
      theme: "modern",
      height: 500,
      plugins: [
        'advlist charmap lists print link image preview hr anchor pagebreak',
        'searchreplace wordcount visualblocks visualchars code fullscreen',
        'insertdatetime nonbreaking save table contextmenu directionality',
        'template paste textcolor colorpicker textpattern'
      ],
      toolbar1: 'insertfile undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | forecolor backcolor | image | fontselect fontsizeselect',
      fontsize_formats: "8px 10px 12px 14px 18px 24px 36px",
      font_formats: 'Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times;Trebuchet MS=trebuchet ms,geneva;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings,zapf dingbats',
      image_advtab: true,
      paste_as_text: true,
      relative_urls: false,
      remove_script_host: false,

      file_picker_callback: function (callback, value, meta) {
        if (meta.filetype === 'image') {
          // Fetch the images from your server or database
          fetch('/admin/image')
            .then(response => {
              if (!response.ok) {
                throw new Error('Failed to fetch images');
              }
              return response.json();  // Assuming the server returns a JSON array of image objects
            })
            .then(images => {
              console.log(images);
              const imageElements = images.map(image => `
                    <div class="image-item" style="display: inline-block; margin: 10px; cursor: pointer;">
                        <img src="${image.url}" 
                             alt="${image.id}" 
                             style="width: 100px; height: auto; border: 2px solid transparent;"
                             onclick="selectImage('${image.url}')" />
                        <div style="text-align: center;">${image.id}</div>
                    </div>
                `).join('');
              console.log(imageElements);

              // Add a global function to handle image selection
              window.selectImage = function (url) {
                callback(url);  // This returns the selected image URL to TinyMCE
                win.close();  // Close the window once the image is selected
              };

              // Open a TinyMCE window (dialog) to display the image gallery
              const win = tinymce.activeEditor.windowManager.open({
                title: 'Select an Image',
                body: {
                  type: 'container',
                  html: `<div style="padding: 20px; max-height: 400px; overflow-y: auto;">
             <div style="display: flex; flex-wrap: wrap; gap: 10px;">
               ${imageElements}
             </div>
           </div>`
                },
                width: 700,
                height: 500
              });
            })
            .catch(error => {
              console.error('Error fetching images:', error);
              tinymce.activeEditor.notificationManager.open({
                text: 'Failed to load images. Please try again.',
                type: 'error'
              });
            });
        }
      }
    });

    async function collectFormData(event) {
      event.preventDefault();

      // Collecting data from the form
      const title = document.querySelector('input[name="title"]').value;
      const urlSlug = document.querySelector('input[name="urlSlug"]').value;
      const pageType = document.querySelector('input[name="pageType"]').value;
      const image = document.querySelector('input[name="image"]').value;
      const file = document.querySelector('input[name="file"]').value;
      const content = tinymce.get('content').getContent(); // Get content from TinyMCE
      const metaTitle = document.querySelector('#meta-title').value;
      const metaKeyword = document.querySelector('#meta-keyword').value;
      const metaDescription = document.querySelector('#meta-description').value;

      // Create an object to hold the data
      const formData = {
        title,
        urlSlug,
        pageType,
        image,
        file,
        content,
        metaTitle,
        metaKeyword,
        metaDescription,
      };

      console.log('Form Data:', formData);

      try {
        const response = await fetch('/admin/pages', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(formData),
        });

        // Check if the response is successful
        if (response.ok) {
          const result = await response.json();

          // Success message using Toastify
          Toastify({
            text: "Your page has been created successfully!",
            duration: 3000,
            gravity: "top",
            close: true,
            position: "right",
            stopOnFocus: true,
            style: {
              background: "linear-gradient(to right, #1c66e3, #051347)",
            }
          }).showToast();

          console.log('Server Response:', result);
        } else {
          const errorData = await response.json();

          // Error message using Toastify
          Toastify({
            text: `There was an error sending your message: ${errorData.message}`,
            duration: 3000,
            gravity: "top",
            close: true,
            position: "right",
            stopOnFocus: true,
            style: {
              background: "linear-gradient(to right, #e3391c, #770505)",
            }
          }).showToast();
        }
      } catch (error) {
        console.error('Error:', error);

        // Failure message using Toastify
        Toastify({
          text: "Failed to send message. Please try again later.",
          duration: 3000,
          gravity: "top",
          close: true,
          position: "right",
          stopOnFocus: true,
          style: {
            background: "linear-gradient(to right, #e3391c, #770505)",
          }
        }).showToast();
      }
    }

    document.querySelector('form').addEventListener('submit', collectFormData);

  </script>
  <script type="text/javascript" src="https://ngyungne.org/public/admin/plugins/standalone.js"></script>
  <script type="text/javascript">
    $("#answer").hide();
    function valueChanged() {

      if ($('#coupon_question').is(":checked"))
        $("#answer").show();
      else
        $("#answer").hide();
    }
  </script>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const modal = document.getElementById('selectorModal');
      const selectorContainer = document.getElementById('selectorContainer');
      let currentInputField = null; // To track whether image or file selector is open

      // Open Image Selector Modal
      document.getElementById('openImageSelector').addEventListener('click', function () {
        openSelectorModal('Image', '/admin/image/slider', 'image');
      });

      // Open File Selector Modal
      document.getElementById('openFileSelector').addEventListener('click', function () {
        openSelectorModal('File', '/admin/Files', 'file');
      });

      // Open the modal and fetch items
      function openSelectorModal(type, apiUrl, inputFieldId) {
        currentInputField = document.getElementById(inputFieldId);
        document.getElementById('modalTitle').textContent = `Select ${type}`;
        selectorContainer.innerHTML = ''; // Clear previous items
        modal.style.display = 'block'; // Show modal (or use a modal library's method)

        // Fetch items
        fetch(apiUrl)
          .then(response => response.json())
          .then(data => {
            if (data.length === 0) {
              selectorContainer.innerHTML = `<p class="text-center w-100">No ${type.toLowerCase()}s available.</p>`;
            } else {
              console.log(data);
              data.forEach(item => {
                const itemHTML = `
                <div class="col-md-3">
                  <div class="thumbnail" style="cursor: pointer;" data-url="${item.url}">
                    <img src="${item.url}" class="img-thumbnail" alt="${item.filename || item.title}">
                    <div class="text-center">${item.filename || item.title}</div>
                  </div>
                </div>
              `;
                selectorContainer.innerHTML += itemHTML;
              });
              // Attach click event to thumbnails
              attachSelectionHandlers();
            }
          })
          .catch(err => {
            console.error(`Error fetching ${type.toLowerCase()}s:`, err);
            alert(`There was an error fetching the ${type.toLowerCase()}s., ${err}`);
          });
      }

      // Attach click handlers to thumbnails
      function attachSelectionHandlers() {
        const thumbnails = selectorContainer.querySelectorAll('.thumbnail');
        thumbnails.forEach(thumbnail => {
          thumbnail.addEventListener('click', function () {
            const url = this.getAttribute('data-url');
            if (currentInputField) {
              currentInputField.value = url; // Set the URL in the input field
            }
            modal.style.display = 'none'; // Close modal
          });
        });
      }

      // Close modal (additional logic if needed)
      modal.querySelector('[data-dismiss="modal"]').addEventListener('click', function () {
        modal.style.display = 'none'; // Hide modal
      });
    });
  </script>


  <script src="https://ngyungne.org/public/admin/plugins/parsley/parsley.min.js"></script>






</body>

</html>